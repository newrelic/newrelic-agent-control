# List of integrations to download.
# Individual entries may override any of the values defined above.
artifacts:
  - name: newrelic-infra
    # Version now should be added in goreleaser.yaml global envs
    url: https://github.com/newrelic/infrastructure-agent/releases/download/{{.Version | trimv}}/newrelic-infra_systemd_{{.Version | trimv}}_{{.Arch}}.deb
    files:
      # infra-agent
      - name: newrelic-infra binary
        src: usr/bin/newrelic-infra
        dest: artifacts/{{.Arch}}/newrelic-infra
      - name: newrelic-infra license
        src: var/db/newrelic-infra/LICENSE.txt
        dest: artifacts/{{.Arch}}/newrelic-infra

      # integrations
      - name: nri-docker binary
        src: opt/newrelic-infra/newrelic-integrations/bin/nri-docker
        dest: artifacts/{{.Arch}}
      - name: nri-docker config
        src: etc/newrelic-infra/integrations.d/docker-config.yml
        dest: artifacts/{{.Arch}}
      - name: nri-prometheus binary
        src: opt/newrelic-infra/newrelic-integrations/bin/nri-prometheus
        dest: artifacts/{{.Arch}}
      - name: nri-flex binary
        src: opt/newrelic-infra/newrelic-integrations/bin/nri-flex
        dest: artifacts/{{.Arch}}
      # fluent-bit conf
      - name: fb parsers.conf
        src: var/db/newrelic-infra/newrelic-integrations/logging/parsers.conf
        dest: artifacts/{{.Arch}}/fluent-bit
      - name: fb nr-plugin
        src: var/db/newrelic-infra/newrelic-integrations/logging/out_newrelic.so
        dest: artifacts/{{.Arch}}/fluent-bit
      # fb examples
      - name: fb example file.yml.example
        src: etc/newrelic-infra/logging.d/file.yml.example
        dest: artifacts/{{.Arch}}/fluent-bit
      - name: fb example file.yml.example
        src: etc/newrelic-infra/logging.d/fluentbit.yml.example
        dest: artifacts/{{.Arch}}/fluent-bit
      - name: fb example syslog.yml.example
        src: etc/newrelic-infra/logging.d/syslog.yml.example
        dest: artifacts/{{.Arch}}/fluent-bit
      - name: fb example systemd.yml.example
        src: etc/newrelic-infra/logging.d/systemd.yml.example
        dest: artifacts/{{.Arch}}/fluent-bit
      - name: fb example tcp.yml.example
        src: etc/newrelic-infra/logging.d/tcp.yml.example
        dest: artifacts/{{.Arch}}/fluent-bit

  - name: nr-otel-collector
    # Version now should be added in goreleaser.yaml global envs
    url: https://github.com/newrelic/nrdot-collector-releases/releases/download/{{.Version | trimv}}/nrdot-collector-host_{{.Version | trimv}}_linux_{{.Arch}}.deb
    files:
      # Important to note the binary name is nrdot-collector-host matching the new nrdot binary
      - name: nt-otel-collector binary
        src: usr/bin/nrdot-collector-host
        dest: artifacts/{{.Arch}}/nr-otel-collector

  # The eBPF agent is not embedded in the agent-control package. Instead, it is
  # installed via its newrelic-cli recipe with services disabled, allowing
  # agent-control to manage its orchestration.
  # name: nr-ebpf-agent
