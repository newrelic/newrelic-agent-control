namespace: custom
name: chart
version: 0.1.0
variables:
  k8s:
    chart_location:
      description: "newrelic-prometheus chart location"
      type: string
      required: true
    chart_name:
      description: "newrelic-prometheus chart name"
      type: string
      required: true
deployment:
  k8s:
    health:
      interval: 30s
    objects:
      repository:
        apiVersion: source.toolkit.fluxcd.io/v1
        kind: GitRepository
        metadata:
          name: ${nr-sub:agent_id}
        spec:
          interval: 5m0s
          url: ${nr-var:chart_location}
          ref:
            branch: master
      release:
        apiVersion: helm.toolkit.fluxcd.io/v2
        kind: HelmRelease
        metadata:
          name: ${nr-sub:agent_id}
        spec:
          interval: 10m
          timeout: 5m
          chart:
            spec:
              chart: ${nr-var:chart_name}
              version: '*'
              sourceRef:
                kind: GitRepository
                name: ${nr-sub:agent_id}
              interval: 5m
          releaseName: ${nr-sub:agent_id}
          values:
            cluster: test
            license: wrong
