namespace: newrelic
name: com.newrelic.apm_python
version: 0.1.0
variables:
  k8s:
    version:
      description: "Python Agent init container version"
      type: string
      default: "latest"
      required: false
    podLabelSelector:
      description: "Pod label selector"
      type: yaml
      default: { }
      required: false
    namespaceLabelSelector:
      description: "Namespace label selector"
      type: yaml
      default: { }
      required: false
    env:
      description: "environment variables to pass to Python agent"
      type: yaml
      default: [ ]
      required: false
    health_env:
      description: "environment variables to pass to health sidecar"
      type: yaml
      default: [ ]
      required: false
    health_version:
      description: "health sidecar image version"
      type: string
      default: "latest"
      required: false
deployment:
  k8s:
    health:
      interval: 30s
    objects:
      instrumentation:
        apiVersion: newrelic.com/v1beta1
        kind: Instrumentation
        metadata:
          name: ${nr-sub:agent_id}
        spec:
          agent:
            language: python
            image: newrelic/newrelic-python-init:${nr-var:version}
            env: ${nr-var:env}
          healthAgent:
            image: newrelic/k8s-apm-agent-health-sidecar:${nr-var:health_version}
            env: ${nr-var:health_env}
          podLabelSelector: ${nr-var:podLabelSelector}
          namespaceLabelSelector: ${nr-var:namespaceLabelSelector}
