{
  extends: [
    'config:recommended',
  ],
  labels: [
    'dependencies',
  ],
  automerge: false,
  lockFileMaintenance: { enabled: true }, // Update transitive dependencies by keeping lockfile updated
  enabledManagers: [
    'cargo',
    'custom.regex',
    'gomod',
  ],
  customManagers: [
    {
      customType: 'regex',
      managerFilePatterns: [
        '/^Dockerfiles/Dockerfile_agent_control_cli$/',
      ],
      depNameTemplate: 'helm/helm',
      datasourceTemplate: 'github-releases',
      matchStrings: [
        'ARG HELM_VERSION=(?<currentValue>.+)',
      ],
    },
    {
      customType: 'regex',
      managerFilePatterns: [
        '/^.goreleaser.yml$/',
      ],
      depNameTemplate: 'newrelic/infrastructure-agent',
      datasourceTemplate: 'github-releases',
      matchStrings: [
        ' *- NEWRELIC_INFRA_AGENT_VERSION=(?<currentValue>.+)',
      ],
    },
    {
      customType: 'regex',
      managerFilePatterns: [
        '/^.goreleaser.yml$/',
      ],
      depNameTemplate: 'newrelic/nrdot-collector-releases',
      datasourceTemplate: 'github-releases',
      matchStrings: [
        ' *- NR_OTEL_COLLECTOR_VERSION=(?<currentValue>.+)',
      ],
    },
    {
      customType: 'regex',
      managerFilePatterns: [
        '**/Cargo.toml',
      ],
      matchStrings: [
        'nr-auth = { git = "https://github\\.com/newrelic/newrelic-auth-rs\\.git", tag = "(?<currentValue>\\d+\\.\\d+\\.\\d+)" }',
      ],
      datasourceTemplate: 'github-tags',
      depNameTemplate: 'newrelic-auth-rs',
      packageNameTemplate: 'newrelic/newrelic-auth-rs',
    },
    {
      customType: 'regex',
      managerFilePatterns: [
        '**/Cargo.toml',
      ],
      matchStrings: [
        'opamp-client = { git = "https://github\\.com/newrelic/newrelic-opamp-rs\\.git", tag = "(?<currentValue>\\d+\\.\\d+\\.\\d+)" }',
      ],
      datasourceTemplate: 'github-tags',
      depNameTemplate: 'newrelic-opamp-rs',
      packageNameTemplate: 'newrelic/newrelic-opamp-rs',
    },
  ],
  rangeStrategy: 'bump',
  prConcurrentLimit: 0,
  printConfig: true,
  prHourlyLimit: 0,
  packageRules: [
    {
      enabled: false,
      matchPackageNames: [
        '/serde_yaml/',
      ],
    },
    { // Group kubernetes crates together
        matchPackagePrefixes: [
            "kube",
            "k8s",
            "schemars",
        ],
        groupName: "kubernetes crates",
        matchManagers: [
            "cargo"
        ],
    },
    {
      matchManagers: [
        'gomod',
      ],
      matchUpdateTypes: [
        'minor',
      ],
      groupName: 'go minor and patch updates',
    },
    {
      matchManagers: [
        'gomod',
      ],
      matchUpdateTypes: [
        'major',
      ],
      groupName: 'go major updates',
    },
  ],
}
