name: ‚èØÔ∏èüöÄüíæ OnHost E2E test on demand

on:
  workflow_dispatch:
    inputs:
      UNIQUE_NAME:
        description: "name of the provisioned machines. default: ci-on-demand"
        required: false
        type: string
      EC2_FILTERS:
        required: false
        description: "OS Flavors to test. default: ubuntu22.04"
        type: string
      REPOSITORY_ENDPOINT:
        required: false
        description: 'Repository endpoint to fetch packages from. default: staging'
        type: string

permissions:
  id-token: write
  contents: read

jobs:
  onhost-e2e:
    uses: ./.github/workflows/component_onhost_e2e.yaml
    with:
      UNIQUE_NAME: ${{ inputs.UNIQUE_NAME || 'ci-on-demand' }}
      EC2_FILTERS: ${{ inputs.EC2_FILTERS || '[\"ubuntu22.04\"]' }}
      REPOSITORY_ENDPOINT: ${{ inputs.REPOSITORY_ENDPOINT || 'https://nr-downloads-ohai-staging.s3.amazonaws.com/'}}
    secrets:
      AWS_ROLE_ARN: ${{ secrets.AWS_ROLE_ARN }}
      AWS_VPC_SUBNET: ${{ secrets.AWS_VPC_SUBNET }}

