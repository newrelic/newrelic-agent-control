namespace: newrelic
name: com.newrelic.infrastructure_agent
version: 0.1.3
variables:
  description: "Newrelic infra configuration"
  type: config
  required: false
  default: ""
  file_path: "newrelic-infra.yml"รง
description: "Newrelic infra configuration"
  type: config
  required: false
  default: ""
  file_path: "newrelic-infra.yml"
deployment_config:
  backoff_delay:
    description: "seconds until next retry if agent fails to start"
    type: string
    required: false
    default: 20s
  enable_file_logging:
    description: "enable logging the on host executables' logs to files"
    type: bool
    required: false
    default: false
  health_port:
    description: "port for the Infra Agent status server"
    type: number
    required: false
    default: 18003
deployment:
  on_host:
    enable_file_logging: ${nr-var:enable_file_logging}
    executables:
      - path: /usr/bin/newrelic-infra
        args: "--config=${nr-var:config_agent}"
        env: "NRIA_PLUGIN_DIR=${autogenerated}/${agent_id}/integrations.d NRIA_LOGGING_CONFIGS_DIR=${nr-var:config_logging} NRIA_STATUS_SERVER_ENABLED=true NRIA_STATUS_SERVER_PORT=${nr-var:health_port}"
        restart_policy:
          backoff_strategy:
            type: fixed
            backoff_delay: ${nr-var:backoff_delay}
        health:
          interval: 5s
          timeout: 5s
          http:
            path: "/v1/status"
            port: ${nr-var:health_port}
