ANSIBLE_FOLDER ?= $(CURDIR)
ANSIBLE_ENV_SCRIPT ?= $(ANSIBLE_FOLDER)/set_ansible_env.sh

export REQUIREMENTS_FILE ?= $(ANSIBLE_FOLDER)/requirements.yml

export ROLES_PATH:=$(ANSIBLE_FOLDER)/roles
export COLLECTIONS_PATH:=$(ANSIBLE_FOLDER)/collections

export CROWDSTRIKE_ROLE_PULL_KEY := $(HOME)/.ssh/crowdstrike_ansible_role_key

$(ROLES_PATH) $(COLLECTIONS_PATH):
	@mkdir -p $@

.PHONY: ansible/dependencies
ansible/dependencies: $(ROLES_PATH) $(COLLECTIONS_PATH)
	sh $(ANSIBLE_ENV_SCRIPT)

.PHONY: ansible/clean
ansible/clean:
	rm -rf $(ROLES_PATH) $(COLLECTIONS_PATH)
