# Cluster and License info is set with "--set" in the e2e-spec file
toolkitImage:
  tag: failIfNotReplaced
agentControlDeployment:
  chartValues:
    image:
      tag: failIfNotReplaced
    subAgentsNamespace: "newrelic-agents"
    systemIdentity:
      create: false
      secretName: "sys-identity"
    config:
      authSecret:
        secretName: "sys-identity"
        secretKeyName: "private_key"
      fleet_control:
        enabled: true
        # Fleet with name 'ac-e2e-apm'.
        fleet_id: NjQyNTg2NXxOR0VQfEZMRUVUfDAxOWI0NTkxLTYyYmEtN2RiZC04OGY5LWQ1MGMzZDU2YTM3YQ
      log:
        insecure_fine_grained_level: newrelic_agent_control=debug,opamp_client=trace,off
      agents:
        infra:
          agent_type: newrelic/com.newrelic.infrastructure:0.1.0
        operator:
          agent_type: newrelic/com.newrelic.k8s_agent_operator:0.1.0
        # One agent per language
        java-agent:
          agent_type: newrelic/com.newrelic.apm_java:0.1.0
        python-agent:
          agent_type: newrelic/com.newrelic.apm_python:0.1.0
        node-agent:
          agent_type: newrelic/com.newrelic.apm_node:0.1.0
        ruby-agent:
          agent_type: newrelic/com.newrelic.apm_ruby:0.1.0
        dotnet-agent:
          agent_type: newrelic/com.newrelic.apm_dotnet:0.1.0
    agentsConfig:
      infra:
        chart_version: "*" # Use latest
        chart_values:
          global: #Â add 'cluster_name' (nri-kubernetes events have 'clusterName' attribute)
            customAttributes:
              cluster_name: ${nr-env:NR_CLUSTER_NAME}
      operator:
        chart_version: "*"
        chart_values:
          k8s-agents-operator:
            controllerManager:
              manager:
                image:
                  repository: "pgallina/poc"
                  version: "apm4"
      # One agent per language
      java-agent:
        applicationName: "my-java-app"
        podLabelSelector:
          matchExpressions:
            - key: "app"
              operator: "In"
              values: [ "javaapp" ]
        containerSelector:
          envSelector:
            matchExpressions:
              - key: NRI
                operator: Exists
      python-agent:
        applicationName: "my-python-app"
        podLabelSelector:
          matchExpressions:
            - key: "app"
              operator: "In"
              values: [ "pythonapp" ]
      node-agent:
        applicationName: "my-node-app"
        podLabelSelector:
          matchExpressions:
            - key: "app"
              operator: "In"
              values: [ "nodeapp" ]
      ruby-agent:
        applicationName: "my-ruby-app"
        podLabelSelector:
          matchExpressions:
            - key: "app"
              operator: "In"
              values: [ "rubyapp" ]
      dotnet-agent:
        applicationName: "my-dotnet-app"
        podLabelSelector:
          matchExpressions:
            - key: "app"
              operator: "In"
              values: [ "dotneteapp" ]
